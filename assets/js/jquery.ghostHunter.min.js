(function(a){!function(){var g=function(t){var e=new g.Index;return e.pipeline.add(g.trimmer,g.stopWordFilter,g.stemmer),t&&t.call(e,e),e};g.version="0.7.0",g.utils={},g.utils.warn=function(e){return function(t){e.console&&console.warn&&console.warn(t)}}(this),g.utils.asString=function(t){return void 0===t||null===t?"":t.toString()},g.EventEmitter=function(){this.events={}},g.EventEmitter.prototype.addListener=function(){var t=Array.prototype.slice.call(arguments),e=t.pop(),i=t;if("function"!=typeof e)throw new TypeError("last argument must be a function");i.forEach(function(t){this.hasHandler(t)||(this.events[t]=[]),this.events[t].push(e)},this)},g.EventEmitter.prototype.removeListener=function(t,e){if(this.hasHandler(t)){var i=this.events[t].indexOf(e);this.events[t].splice(i,1),this.events[t].length||delete this.events[t]}},g.EventEmitter.prototype.emit=function(t){if(this.hasHandler(t)){var e=Array.prototype.slice.call(arguments,1);this.events[t].forEach(function(t){t.apply(void 0,e)})}},g.EventEmitter.prototype.hasHandler=function(t){return t in this.events},g.tokenizer=function(t){return arguments.length&&null!=t&&void 0!=t?Array.isArray(t)?t.map(function(t){return g.utils.asString(t).toLowerCase()}):t.toString().trim().toLowerCase().split(g.tokenizer.seperator):[]},g.tokenizer.seperator=/[\s\-]+/,g.tokenizer.load=function(t){var e=this.registeredFunctions[t];if(!e)throw new Error("Cannot load un-registered function: "+t);return e},g.tokenizer.label="default",g.tokenizer.registeredFunctions={default:g.tokenizer},g.tokenizer.registerFunction=function(t,e){e in this.registeredFunctions&&g.utils.warn("Overwriting existing tokenizer: "+e),t.label=e,this.registeredFunctions[e]=t},g.Pipeline=function(){this._stack=[]},g.Pipeline.registeredFunctions={},g.Pipeline.registerFunction=function(t,e){e in this.registeredFunctions&&g.utils.warn("Overwriting existing registered function: "+e),t.label=e,g.Pipeline.registeredFunctions[t.label]=t},g.Pipeline.warnIfFunctionNotRegistered=function(t){var e=t.label&&t.label in this.registeredFunctions;e||g.utils.warn("Function is not registered with pipeline. This may cause problems when serialising the index.\n",t)},g.Pipeline.load=function(t){var i=new g.Pipeline;return t.forEach(function(t){var e=g.Pipeline.registeredFunctions[t];if(!e)throw new Error("Cannot load un-registered function: "+t);i.add(e)}),i},g.Pipeline.prototype.add=function(){var t=Array.prototype.slice.call(arguments);t.forEach(function(t){g.Pipeline.warnIfFunctionNotRegistered(t),this._stack.push(t)},this)},g.Pipeline.prototype.after=function(t,e){g.Pipeline.warnIfFunctionNotRegistered(e);var i=this._stack.indexOf(t);if(-1==i)throw new Error("Cannot find existingFn");i+=1,this._stack.splice(i,0,e)},g.Pipeline.prototype.before=function(t,e){g.Pipeline.warnIfFunctionNotRegistered(e);var i=this._stack.indexOf(t);if(-1==i)throw new Error("Cannot find existingFn");this._stack.splice(i,0,e)},g.Pipeline.prototype.remove=function(t){var e=this._stack.indexOf(t);-1!=e&&this._stack.splice(e,1)},g.Pipeline.prototype.run=function(t){for(var e=[],i=t.length,n=this._stack.length,r=0;i>r;r++){for(var o=t[r],s=0;n>s&&(o=this._stack[s](o,r,t),void 0!==o&&""!==o);s++);void 0!==o&&""!==o&&e.push(o)}return e},g.Pipeline.prototype.reset=function(){this._stack=[]},g.Pipeline.prototype.toJSON=function(){return this._stack.map(function(t){return g.Pipeline.warnIfFunctionNotRegistered(t),t.label})},g.Vector=function(){this._magnitude=null,this.list=void 0,this.length=0},g.Vector.Node=function(t,e,i){this.idx=t,this.val=e,this.next=i},g.Vector.prototype.insert=function(t,e){this._magnitude=void 0;var i=this.list;if(!i)return this.list=new g.Vector.Node(t,e,i),this.length++;if(t<i.idx)return this.list=new g.Vector.Node(t,e,i),this.length++;for(var n=i,r=i.next;void 0!=r;){if(t<r.idx)return n.next=new g.Vector.Node(t,e,r),this.length++;n=r,r=r.next}return n.next=new g.Vector.Node(t,e,r),this.length++},g.Vector.prototype.magnitude=function(){if(this._magnitude)return this._magnitude;for(var t,e=this.list,i=0;e;)t=e.val,i+=t*t,e=e.next;return this._magnitude=Math.sqrt(i)},g.Vector.prototype.dot=function(t){for(var e=this.list,i=t.list,n=0;e&&i;)e.idx<i.idx?e=e.next:e.idx>i.idx?i=i.next:(n+=e.val*i.val,e=e.next,i=i.next);return n},g.Vector.prototype.similarity=function(t){return this.dot(t)/(this.magnitude()*t.magnitude())},g.SortedSet=function(){this.length=0,this.elements=[]},g.SortedSet.load=function(t){var e=new this;return e.elements=t,e.length=t.length,e},g.SortedSet.prototype.add=function(){var t,e;for(t=0;t<arguments.length;t++)e=arguments[t],~this.indexOf(e)||this.elements.splice(this.locationFor(e),0,e);this.length=this.elements.length},g.SortedSet.prototype.toArray=function(){return this.elements.slice()},g.SortedSet.prototype.map=function(t,e){return this.elements.map(t,e)},g.SortedSet.prototype.forEach=function(t,e){return this.elements.forEach(t,e)},g.SortedSet.prototype.indexOf=function(t){for(var e=0,i=this.elements.length,n=i-e,r=e+Math.floor(n/2),o=this.elements[r];n>1;){if(o===t)return r;t>o&&(e=r),o>t&&(i=r),n=i-e,r=e+Math.floor(n/2),o=this.elements[r]}return o===t?r:-1},g.SortedSet.prototype.locationFor=function(t){for(var e=0,i=this.elements.length,n=i-e,r=e+Math.floor(n/2),o=this.elements[r];n>1;)t>o&&(e=r),o>t&&(i=r),n=i-e,r=e+Math.floor(n/2),o=this.elements[r];return o>t?r:t>o?r+1:void 0},g.SortedSet.prototype.intersect=function(t){for(var e=new g.SortedSet,i=0,n=0,r=this.length,o=t.length,s=this.elements,a=t.elements;;){if(i>r-1||n>o-1)break;s[i]!==a[n]?s[i]<a[n]?i++:s[i]>a[n]&&n++:(e.add(s[i]),i++,n++)}return e},g.SortedSet.prototype.clone=function(){var t=new g.SortedSet;return t.elements=this.toArray(),t.length=t.elements.length,t},g.SortedSet.prototype.union=function(t){var e,i,n;this.length>=t.length?(e=this,i=t):(e=t,i=this),n=e.clone();for(var r=0,o=i.toArray();r<o.length;r++)n.add(o[r]);return n},g.SortedSet.prototype.toJSON=function(){return this.toArray()},g.Index=function(){this._fields=[],this._ref="id",this.pipeline=new g.Pipeline,this.documentStore=new g.Store,this.tokenStore=new g.TokenStore,this.corpusTokens=new g.SortedSet,this.eventEmitter=new g.EventEmitter,this.tokenizerFn=g.tokenizer,this._idfCache={},this.on("add","remove","update",function(){this._idfCache={}}.bind(this))},g.Index.prototype.on=function(){var t=Array.prototype.slice.call(arguments);return this.eventEmitter.addListener.apply(this.eventEmitter,t)},g.Index.prototype.off=function(t,e){return this.eventEmitter.removeListener(t,e)},g.Index.load=function(t){t.version!==g.version&&g.utils.warn("version mismatch: current "+g.version+" importing "+t.version);var e=new this;return e._fields=t.fields,e._ref=t.ref,e.tokenizer=g.tokenizer.load(t.tokenizer),e.documentStore=g.Store.load(t.documentStore),e.tokenStore=g.TokenStore.load(t.tokenStore),e.corpusTokens=g.SortedSet.load(t.corpusTokens),e.pipeline=g.Pipeline.load(t.pipeline),e},g.Index.prototype.field=function(t,e){var e=e||{},i={name:t,boost:e.boost||1};return this._fields.push(i),this},g.Index.prototype.ref=function(t){return this._ref=t,this},g.Index.prototype.tokenizer=function(t){var e=t.label&&t.label in g.tokenizer.registeredFunctions;return e||g.utils.warn("Function is not a registered tokenizer. This may cause problems when serialising the index"),this.tokenizerFn=t,this},g.Index.prototype.add=function(r,t){var o={},s=new g.SortedSet,e=r[this._ref],t=void 0===t?!0:t;this._fields.forEach(function(t){var e=this.pipeline.run(this.tokenizerFn(r[t.name]));o[t.name]=e;for(var i=0;i<e.length;i++){var n=e[i];s.add(n),this.corpusTokens.add(n)}},this),this.documentStore.set(e,s);for(var i=0;i<s.length;i++){for(var n=s.elements[i],a=0,l=0;l<this._fields.length;l++){var h=this._fields[l],u=o[h.name],f=u.length;if(f){for(var c=0,d=0;f>d;d++)u[d]===n&&c++;a+=c/f*h.boost}}this.tokenStore.add(n,{ref:e,tf:a})}t&&this.eventEmitter.emit("add",r,this)},g.Index.prototype.remove=function(t,e){var i=t[this._ref],e=void 0===e?!0:e;if(this.documentStore.has(i)){var n=this.documentStore.get(i);this.documentStore.remove(i),n.forEach(function(t){this.tokenStore.remove(t,i)},this),e&&this.eventEmitter.emit("remove",t,this)}},g.Index.prototype.update=function(t,e){var e=void 0===e?!0:e;this.remove(t,!1),this.add(t,!1),e&&this.eventEmitter.emit("update",t,this)},g.Index.prototype.idf=function(t){var e="@"+t;if(Object.prototype.hasOwnProperty.call(this._idfCache,e))return this._idfCache[e];var i=this.tokenStore.count(t),n=1;return i>0&&(n=1+Math.log(this.documentStore.length/i)),this._idfCache[e]=n},g.Index.prototype.search=function(t){var e=this.pipeline.run(this.tokenizerFn(t)),p=new g.Vector,n=[],r=this._fields.reduce(function(t,e){return t+e.boost},0),i=e.some(function(t){return this.tokenStore.has(t)},this);if(!i)return[];e.forEach(function(f,t,e){var c=1/e.length*this._fields.length*r,d=this,i=this.tokenStore.expand(f).reduce(function(t,e){var i=d.corpusTokens.indexOf(e),n=d.idf(e),r=1,o=new g.SortedSet;if(e!==f){var s=Math.max(3,e.length-f.length);r=1/Math.log(s)}i>-1&&p.insert(i,c*n*r);for(var a=d.tokenStore.get(e),l=Object.keys(a),h=l.length,u=0;h>u;u++)o.add(a[l[u]].ref);return t.union(o)},new g.SortedSet);n.push(i)},this);var o=n.reduce(function(t,e){return t.intersect(e)});return o.map(function(t){return{ref:t,score:p.similarity(this.documentVector(t))}},this).sort(function(t,e){return e.score-t.score})},g.Index.prototype.documentVector=function(t){for(var e=this.documentStore.get(t),i=e.length,n=new g.Vector,r=0;i>r;r++){var o=e.elements[r],s=this.tokenStore.get(o)[t].tf,a=this.idf(o);n.insert(this.corpusTokens.indexOf(o),s*a)}return n},g.Index.prototype.toJSON=function(){return{version:g.version,fields:this._fields,ref:this._ref,tokenizer:this.tokenizerFn.label,documentStore:this.documentStore.toJSON(),tokenStore:this.tokenStore.toJSON(),corpusTokens:this.corpusTokens.toJSON(),pipeline:this.pipeline.toJSON()}},g.Index.prototype.use=function(t){var e=Array.prototype.slice.call(arguments,1);e.unshift(this),t.apply(this,e)},g.Store=function(){this.store={},this.length=0},g.Store.load=function(i){var t=new this;return t.length=i.length,t.store=Object.keys(i.store).reduce(function(t,e){return t[e]=g.SortedSet.load(i.store[e]),t},{}),t},g.Store.prototype.set=function(t,e){this.has(t)||this.length++,this.store[t]=e},g.Store.prototype.get=function(t){return this.store[t]},g.Store.prototype.has=function(t){return t in this.store},g.Store.prototype.remove=function(t){this.has(t)&&(delete this.store[t],this.length--)},g.Store.prototype.toJSON=function(){return{store:this.store,length:this.length}},g.stemmer=function(){var h={ational:"ate",tional:"tion",enci:"ence",anci:"ance",izer:"ize",bli:"ble",alli:"al",entli:"ent",eli:"e",ousli:"ous",ization:"ize",ation:"ate",ator:"ate",alism:"al",iveness:"ive",fulness:"ful",ousness:"ous",aliti:"al",iviti:"ive",biliti:"ble",logi:"log"},u={icate:"ic",ative:"",alize:"al",iciti:"ic",ical:"ic",ful:"",ness:""},t="[^aeiou]",e="[aeiouy]",i=t+"[^aeiouy]*",n=e+"[aeiou]*",r="^("+i+")?"+n+i,o="^("+i+")?"+n+i+"("+n+")?$",s="^("+i+")?"+n+i+n+i,a="^("+i+")?"+e,f=new RegExp(r),c=new RegExp(s),d=new RegExp(o),p=new RegExp(a),g=/^(.+?)(ss|i)es$/,m=/^(.+?)([^s])s$/,v=/^(.+?)eed$/,y=/^(.+?)(ed|ing)$/,S=/.$/,w=/(at|bl|iz)$/,k=new RegExp("([^aeiouylsz])\\1$"),b=new RegExp("^"+i+e+"[^aeiouwxy]$"),x=/^(.+?[^aeiou])y$/,_=/^(.+?)(ational|tional|enci|anci|izer|bli|alli|entli|eli|ousli|ization|ation|ator|alism|iveness|fulness|ousness|aliti|iviti|biliti|logi)$/,E=/^(.+?)(icate|ative|alize|iciti|ical|ful|ness)$/,F=/^(.+?)(al|ance|ence|er|ic|able|ible|ant|ement|ment|ent|ou|ism|ate|iti|ous|ive|ize)$/,z=/^(.+?)(s|t)(ion)$/,I=/^(.+?)e$/,P=/ll$/,O=new RegExp("^"+i+e+"[^aeiouwxy]$"),l=function(t){var e,i,n,r,o,s,a;if(t.length<3)return t;if(n=t.substr(0,1),"y"==n&&(t=n.toUpperCase()+t.substr(1)),r=g,o=m,r.test(t)?t=t.replace(r,"$1$2"):o.test(t)&&(t=t.replace(o,"$1$2")),r=v,o=y,r.test(t)){var l=r.exec(t);r=f,r.test(l[1])&&(r=S,t=t.replace(r,""))}else if(o.test(t)){var l=o.exec(t);e=l[1],o=p,o.test(e)&&(t=e,o=w,s=k,a=b,o.test(t)?t+="e":s.test(t)?(r=S,t=t.replace(r,"")):a.test(t)&&(t+="e"))}if(r=x,r.test(t)){var l=r.exec(t);e=l[1],t=e+"i"}if(r=_,r.test(t)){var l=r.exec(t);e=l[1],i=l[2],r=f,r.test(e)&&(t=e+h[i])}if(r=E,r.test(t)){var l=r.exec(t);e=l[1],i=l[2],r=f,r.test(e)&&(t=e+u[i])}if(r=F,o=z,r.test(t)){var l=r.exec(t);e=l[1],r=c,r.test(e)&&(t=e)}else if(o.test(t)){var l=o.exec(t);e=l[1]+l[2],o=c,o.test(e)&&(t=e)}if(r=I,r.test(t)){var l=r.exec(t);e=l[1],r=c,o=d,s=O,(r.test(e)||o.test(e)&&!s.test(e))&&(t=e)}return r=P,o=c,r.test(t)&&o.test(t)&&(r=S,t=t.replace(r,"")),"y"==n&&(t=n.toLowerCase()+t.substr(1)),t};return l}(),g.Pipeline.registerFunction(g.stemmer,"stemmer"),g.generateStopWordFilter=function(t){var e=t.reduce(function(t,e){return t[e]=e,t},{});return function(t){return t&&e[t]!==t?t:void 0}},g.stopWordFilter=g.generateStopWordFilter(["a","able","about","across","after","all","almost","also","am","among","an","and","any","are","as","at","be","because","been","but","by","can","cannot","could","dear","did","do","does","either","else","ever","every","for","from","get","got","had","has","have","he","her","hers","him","his","how","however","i","if","in","into","is","it","its","just","least","let","like","likely","may","me","might","most","must","my","neither","no","nor","not","of","off","often","on","only","or","other","our","own","rather","said","say","says","she","should","since","so","some","than","that","the","their","them","then","there","these","they","this","tis","to","too","twas","us","wants","was","we","were","what","when","where","which","while","who","whom","why","will","with","would","yet","you","your"]),g.Pipeline.registerFunction(g.stopWordFilter,"stopWordFilter"),g.trimmer=function(t){return t.replace(/^\W+/,"").replace(/\W+$/,"")},g.Pipeline.registerFunction(g.trimmer,"trimmer"),g.TokenStore=function(){this.root={docs:{}},this.length=0},g.TokenStore.load=function(t){var e=new this;return e.root=t.root,e.length=t.length,e},g.TokenStore.prototype.add=function(t,e,i){var i=i||this.root,n=t.charAt(0),r=t.slice(1);return n in i||(i[n]={docs:{}}),0===r.length?(i[n].docs[e.ref]=e,void(this.length+=1)):this.add(r,e,i[n])},g.TokenStore.prototype.has=function(t){if(!t)return!1;for(var e=this.root,i=0;i<t.length;i++){if(!e[t.charAt(i)])return!1;e=e[t.charAt(i)]}return!0},g.TokenStore.prototype.getNode=function(t){if(!t)return{};for(var e=this.root,i=0;i<t.length;i++){if(!e[t.charAt(i)])return{};e=e[t.charAt(i)]}return e},g.TokenStore.prototype.get=function(t,e){return this.getNode(t,e).docs||{}},g.TokenStore.prototype.count=function(t,e){return Object.keys(this.get(t,e)).length},g.TokenStore.prototype.remove=function(t,e){if(t){for(var i=this.root,n=0;n<t.length;n++){if(!(t.charAt(n)in i))return;i=i[t.charAt(n)]}delete i.docs[e]}},g.TokenStore.prototype.expand=function(e,i){var t=this.getNode(e),n=t.docs||{},i=i||[];return Object.keys(n).length&&i.push(e),Object.keys(t).forEach(function(t){"docs"!==t&&i.concat(this.expand(e+t,i))},this),i},g.TokenStore.prototype.toJSON=function(){return{root:this.root,length:this.length}},function(t,e){"function"==typeof define&&define.amd?define(e):"object"==typeof exports?module.exports=e():t.lunr=e()}(this,function(){return g})}();a.fn.ghostHunter=function(t){var e=a.extend({},a.fn.ghostHunter.defaults,t);if(e.results){i.init(this,e);return i}};a.fn.ghostHunter.defaults={resultsData:false,onPageLoad:false,onKeyUp:false,result_template:"<a href='{{link}}'><p><h2>{{title}}</h2><h4>{{prettyPubDate}}</h4></p></a>",info_template:"<p>Number of posts found: {{amount}}</p>",displaySearchInfo:true,zeroResultsInfo:true,before:false,onComplete:false,includepages:false,filterfields:false};var l=function(t){var e=new Date(t);var i=["January","February","March","April","May","June","July","August","September","October","November","December"];return e.getDate()+" "+i[e.getMonth()]+" "+e.getFullYear()};var i={isInit:false,init:function(e,t){var i=this;this.target=e;this.results=t.results;this.blogData={};this.result_template=t.result_template;this.info_template=t.info_template;this.zeroResultsInfo=t.zeroResultsInfo;this.displaySearchInfo=t.displaySearchInfo;this.before=t.before;this.onComplete=t.onComplete;this.includepages=t.includepages;this.filterfields=t.filterfields;this.index=lunr(function(){this.field("title",{boost:10});this.field("description");this.field("link");this.field("markdown",{boost:5});this.field("pubDate");this.field("tag");this.field("feature_image");this.ref("id")});if(t.onPageLoad){i.loadAPI()}else{e.focus(function(){i.loadAPI()})}e.closest("form").submit(function(t){t.preventDefault();i.find(e.val())});if(t.onKeyUp){e.keyup(function(){i.find(e.val())})}},loadAPI:function(){if(this.isInit)return false;var o=this.index,s=this.blogData;obj={limit:"all",include:"tags"};if(this.includepages){obj.filter="(page:true,page:false)"}a.get(ghost.url.api("posts",obj)).done(function(t){searchData=t.posts;searchData.forEach(function(t){var e=t.tags.map(function(t){return t.name});if(t.meta_description==null){t.meta_description=""}var i=e.join(", ");if(i.length<1){i="undefined"}var n={id:String(t.id),title:String(t.title),description:String(t.meta_description),markdown:String(t.markdown),pubDate:String(t.created_at),tag:i,link:String(t.url),feature_image:String(t.feature_image)};n.prettyPubDate=l(n.pubDate);var r=l(n.pubDate);o.add(n);s[t.id]={title:t.title,description:t.meta_description,pubDate:r,link:t.url,feature_image:t.feature_image}})});this.isInit=true},find:function(t){var e=this.index.search(t);var i=a(this.results);var n=[];i.empty();if(this.before){this.before()}if(this.zeroResultsInfo||e.length>0){if(this.displaySearchInfo)i.append(this.format(this.info_template,{amount:e.length}))}for(var r=0;r<e.length;r++){var o=e[r].ref;var s=this.blogData[o];i.append(this.format(this.result_template,s));n.push(s)}if(this.onComplete){this.onComplete(n)}},clear:function(){a(this.results).empty();this.target.val("")},format:function(t,n){return t.replace(/{{([^{}]*)}}/g,function(t,e){var i=n[e];return typeof i==="string"||typeof i==="number"?i:t})}}})(jQuery);